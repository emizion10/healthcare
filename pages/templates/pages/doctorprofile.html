{% extends 'pages/base.html' %}
{% block title %}Profile{% endblock %}
{% load static %}
{% block script %}


<style>
    * {
  box-sizing: border-box;
  -webkit-transition: 0.3s cubic-bezier(0.75, 0, 0.2, 1), color 0.3s ease;
  transition: 0.3s cubic-bezier(0.75, 0, 0.2, 1), color 0.3s ease;
}
.rela-block {
  display: block;
  position: relative;
  margin: auto;
}
.floated {
  display: inline-block;
  position: relative;
  margin: false;
  /* top: ;
  left: ;
  right: ;
  bottom: ; */
  /* float: left; */
}
.floated.right {
  float: right;
}
.abs-center {
  display: false;
  position: absolute;
  margin: false;
  top: 50%;
  left: 50%;
  right: false;
  bottom: false;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  text-align: center;
  width: 88%;
}
.vert-center {
  display: false;
  position: absolute;
  margin: false;
  top: 50%;
  
  -webkit-transform: translateY(-50%);
          transform: translateY(-50%);
}
.horz-center {
  display: false;
  position: absolute;
  margin: false;
  top: false;
  left: 50%;
  right: false;
  bottom: false;
  -webkit-transform: translateX(-50%);
          transform: translateX(-50%);
}
.overlay-card {
  height: 75vh;
  min-height: 400px;
  width: calc(92% - 40px);
  max-width: 1086px;
  padding-left: 30px;
  background-color: #f4f4f4;
  border-radius: 2px;
  overflow: hidden;
}

.profile-card {
  width: calc(100% - 40px);
  padding-top: 100px;
  margin: 70px auto 30px;
  background-color: #fff;
  box-shadow: 0 2px 6px -2px rgba(0,0,0,0.26);
}
.profile-pic {
  display: false;
  position: absolute;
  margin: false;
  top: -90px;
  left: 50%;
  right: false;
  bottom: false;
  -webkit-transform: translateX(-50%);
          transform: translateX(-50%);
  height: 180px;
  width: 180px;
  border: 10px solid #fff;
  border-radius: 100%;
  background: url("{{ doctor.imagefile.url }}") center no-repeat;
  background-size: cover;
}
.profile-name-container {
  margin: 0 auto 10px;
  padding: 10px;
  text-align: center;
}
.user-name {
  font-family: "Montserrat";
  font-size: 24px;
  letter-spacing: 3px;
  font-weight: 400;
  line-height: 30px;
  margin-bottom: 12px;
}
.user-desc {
  letter-spacing: 1px;
  color: #999;
}
.profile-card-stats {
  height: 75px;
  padding: 10px 0px;
  text-align: center;
  overflow: hidden;
}
.profile-stat {
  height: 100%;
  width: 33.3333%;
}
.profile-stat:after {
  color: #999;
}


  .profile-card-stats {
    height: 0;
    padding: 0px;
  }
  .profile-pic {
    height: 140px;
    width: 140px;
    top: -70px;
  }
  .profile-card {
    padding-top: 70px;
    margin: 50px auto 30px;
  }


/* Popup message form */
#loginPopup,#reviewpopup {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1; /* Sit on top */
      padding-top: 100px; /* Location of the box */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: rgb(0,0,0); /* Fallback color */
      background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
      }
      .form-popup {
      border: 2px solid #666;
      z-index: 9;
      max-width: 300px;
      margin: 0 auto;
      }
      .form-container {
      max-width: 300px;
      padding: 20px;
      background-color: #fff;
      }
      /* Full-width for input fields */
      .form-container input[type=text], .form-container textarea {
      width: 100%;
      padding: 10px;
      margin: 5px 0 22px 0;
      border: none;
      background: #eee;
      }
      /* When the inputs get focus, do something */
      .form-container input[type=text]:focus, .form-container textarea:focus {
      background-color: #ddd;
      outline: none;
      }
      /* Style submit/login button */
      .form-container .btn {
      background-color: #8ebf42;
      color: #fff;
      padding: 12px 20px;
      border: none;
      cursor: pointer;
      width: 100%;
      margin-bottom:10px;
      opacity: 0.8;
      }
      /* Style cancel button */
      .form-container .cancel {
      background-color: #cc0000;
      }
      /* Hover effects for buttons */
      .form-container .btn:hover, .open-button:hover {
      opacity: 1;
      }
      nav li {display:inline-block;}
     

      /* Education Popup */
        #abc,#exp {
        width:100%;
        height:100%;
        opacity:.95;
        top:0;
        left:0;
        display:none;
        position:fixed;
        background-color:#313131;
        overflow:auto;


        }
        img#close {
        position:absolute;
        right:-14px;  
        top:-16px;
        cursor:pointer;
        width: 30px;
        height: 30px;
        border-radius: 15px;
        }
        div#popupContact {
        position:absolute;
        left:50%;
        top:17%;
        margin-left:-202px;
        font-family:'Raleway',sans-serif
        }

        #formed {
        max-width:400px;
        min-width:250px;
        padding:10px 50px;
        border:2px solid gray;
        border-radius:10px;
        font-family:raleway;
        background-color:#fff
        }
        .inped {
        width:100%;
        padding:10px;
        margin-top:30px;
        border:1px solid #ccc;
        padding-left:40px;
        font-size:16px;
        font-family:raleway
        }

        textarea {
        background-repeat:no-repeat;
        background-position:5px 7px;
        width:100%;
        height:95px;
        padding:10px;
        resize:none;
        margin-top:30px;
        border:1px solid #ccc;
        padding-left:40px;
        font-size:16px;
        font-family:raleway;
        margin-bottom:30px
        }

        #submit {
        text-decoration:none;
        width:100%;
        text-align:center;
        display:block;
        background-color:#FFBC00;
        color:#fff;
        border:1px solid #FFCB00;
        padding:10px 0;
        font-size:20px;
        cursor:pointer;
        border-radius:5px
        }

        #name {
        background-repeat:no-repeat;
        background-position:5px 7px
        }

        .nav-tabs .glyphicon:not(.no-margin) { margin-right:10px; }
       
       .tab-pane .list-group .glyphicon { margin-right:5px; }
       .tab-pane .list-group .glyphicon:hover { color:#FFBC00; }

</style>
{% endblock %}

{% block content %}
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css"
  rel="stylesheet" id="bootstrap-css">
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js"
  type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet"
  type="text/css" />
<link
  href="https://fonts.googleapis.com/css?family=Montserrat|Roboto:300,400|Yellowtail"
  rel="stylesheet">


<script src="{% static 'js/jquery.star-rating-svg.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'css/star-rating-svg.css' %}">

{% if user.user_type == 1 %}


&nbsp;
<button style="float: right;margin-left: 1opx;" class="btn btn-success"
  onclick="openFormreview()">
  <!-- <a style="color: white;" href="{% url 'doctorreview' %}">Add a Review</a> -->Add
  Review
</button>


{% elif user.user_type == 2 %}

{% endif %}


{% if follow == 'True' %}

<button style="float: right;margin-right: 10px;" class="btn btn-danger">

  <a style="color: white;" href="{% url 'unfollowdoctor' pk=doctor.id %}">Unfollow</a>
</button>
&nbsp;

<button class="open-button btn btn-success" onclick="openForm()">
  <strong>Message</strong>
</button>

{% elif follow == 'False' %}
<button style="float: right;margin-right: 10px;" class="btn btn-primary">
  <a style="color: white;" href="{% url 'followdoctor' pk=doctor.id %}">Follow</a>
</button>
&nbsp;

<button class="open-button btn btn-success" onclick="openForm()">
  <strong>Message</strong>
</button>

{% endif %}

<!-- Sent Message -->


<div id="loginPopup">
  <div class="form-popup" id="popupForm">
    <form action="{% url 'sendmessage' %}" class="form-container">
      {% csrf_token %}
      <h2>Message</h2>
      <label for="email">
        <strong>Subject</strong>
      </label>
      <input type="text" id="email" placeholder="Subject" name="subject"
        required>
      <label for="psw">
        <strong>Content</strong>
      </label>
      <textarea id="psw" placeholder="Content" name="content" required></textarea>
      <input type="hidden" value="{{doctor.username}}" name="reciever">
      <button type="submit" class="btn">Send</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Cancel</button>
    </form>
  </div>
</div>



<!-- Profile Card -->


<div class="rela-block profile-card">
  <div class="profile-pic" id="profile_pic">

  </div>
  <div class="rela-block profile-name-container">
    <div class="rela-block user-name" id="user_name">{{doctor.dname}}</div>
    <div class="rela-block user-desc" id="user_description">{{doctor.get_gender_display}}</div><br>
    <div class="rela-block user-desc" id="user_description">Reg
      Id:{{doctor.regid}}</div><br>
    <div class="rela-block user-desc" id="user_description">Contact:{{doctor.contact}}</div><br>

    <div class="rela-block user-desc" id="user_description">State:{{doctor.state}}</div><br>
    <div class="rela-block user-desc" id="user_description">Email:{{doctor.email}}</div><br>
    <div class="rela-block user-desc" id="user_description">Date of Birth
      :{{doctor.dob}}</div><br>
    <div class="rela-block user-desc" id="user_description">Specialisation:{{doctor.spec}}</div><br>
    <div class="rela-block user-desc" id="user_description">Location
      :{{doctor.location.place}}</div><br>


  </div>
{%  if profile %}

<center>
  <a href="{% url 'changepassword' %}" class='btn btn-success'>Change Password</a>
</center>
{% endif %}

<hr>
  <!-- Navigation -->

  <ul class="nav nav-tabs">
    <li class="active"><a href="#education" data-toggle="tab"><span
          class="glyphicon glyphicon-inbox">
        </span>Education</a></li>
    <li><a href="#experience" data-toggle="tab"><span class="glyphicon
          glyphicon-share"></span>
        Experience</a></li>

    <li><a href="#reviews" data-toggle="tab"><span class="glyphicon
          glyphicon-inbox">
        </span>Reviews</a></li>
  </ul>

  <br>


  <div class="tab-content">
    <div class="tab-pane fade in active" id="education">
      <div class="container-fluid">
       
        {%  if profile%}

        <button class="btn btn-info" style="float: right;" onclick="div_show()">Add
          Education</button>
        <br><br>
        <hr>
        {% endif %}

        {% for ed in education %}
        <h4>Degree : {{ed.degree_name}}</h4>
        <h4>Institute : {{ed.institute_name}}</h4>
        <h4>Timeline : {{ed.date_start}} - {{ed.date_end}}</h4>
        <h4>Description : {{ed.description}}</h4>

        <hr>
        {% endfor %}
      </div>
    </div>

    <div class="tab-pane fade"id="experience">
      <div class="container-fluid">
        {%  if profile %}

        <button class="btn btn-info" style="float: right;" onclick="exp_show()">Add
          Experience</button>
        <br><br>
        <hr>
        {% endif %}

        {% for ed in experience %}
        <h4>Degree : {{ed.designation}}</h4>
        <h4>Institute : {{ed.organisation}}</h4>
        <h4>Timeline : {{ed.date_start}} - {{ed.date_end}}</h4>
        <h4>Description : {{ed.description}}</h4>

        <hr>
        {% endfor %}
      </div>
    </div>
    <div class="tab-pane fade"id="reviews">
      <div class="container-fluid">

        {% for ed in review %}
        <h4 >Rating : {{ed.rating}}</h4>
        <div id='ed' ></div>
        <h4>Author : {{ed.author}}</h4>
        <h4>Description : {{ed.description}}</h4>
        <h4>Date : {{ed.date}}</h4>


        <hr>
        {% endfor %}
      </div>
    </div>
  </div>


  <!-- Add Education -->

  <div id="abc">
    <div id="popupContact">

      <form action="{% url 'addeducation' %}" id="formed" method="post"
        name="form">
        {% csrf_token %}
        <img id="close" src="/media/img/close.jpg" onclick="div_hide()">
        <h2>Add Education</h2>

        <input class="inped" name="degree" placeholder="Degree" type="text">
        <input class="inped" name="institute" placeholder="Institute"
          type="text">
        <input type="text" name="date_start" placeholder="Date From"
          id="datefrom"
          style="width:100%;
          padding:10px;
          margin-top:30px;
          border:1px solid #ccc;
          padding-left:40px;
          font-size:16px;
          font-family:raleway" />


        <input type="text" name="date_end" placeholder="Date To" id="dateto"
          style="width:100%;
          padding:10px;
          margin-top:30px;
          border:1px solid #ccc;
          padding-left:40px;
          font-size:16px;
          font-family:raleway" />



        <br>
        <textarea id="msg" name="desc" placeholder="Description"></textarea>
        <br><br>
        <button id="submit">Add</button>
      </form>
    </div>
  </div>


  <!-- Add Experience -->


  <div id="exp">
    <div id="popupContact">

      <form action="{% url 'addexperience' %}" id="formed" method="post"
        name="form">
        {% csrf_token %}
        <img id="close" src="/media/img/close.jpg" onclick="exp_hide()">
        <h2>Add Experience</h2>

        <input class="inped" name="degree" placeholder="Designation"
          type="text">
        <input class="inped" name="institute" placeholder="Organisation"
          type="text">
        <input type="text" name="date_start" placeholder="Date From"
          id="expdatefrom"
          style="width:100%;
          padding:10px;
          margin-top:30px;
          border:1px solid #ccc;
          padding-left:40px;
          font-size:16px;
          font-family:raleway" />


        <input type="text" name="date_end" placeholder="Date To" id="expdateto"
          style="width:100%;
          padding:10px;
          margin-top:30px;
          border:1px solid #ccc;
          padding-left:40px;
          font-size:16px;
          font-family:raleway" />



        <br>
        <textarea id="msg" name="desc" placeholder="Description"></textarea>
        <br><br>
        <button id="submit">Add</button>
      </form>
    </div>
  </div>



  <!-- Add Review -->

  <div id="reviewpopup">
    <div class="form-popup" id="popupForm">
      <form action="{% url 'doctorreview' %}" class="form-container"
        method="POST">
        {% csrf_token %}

        <h2>Review</h2>
        <label for="email">
          <strong>Rating</strong>
        </label>

        <div class="my-rating"></div>
        <input style="display: none;" type="number" id='rating' name='rating'>
        <label for="psw">
          <strong>Feedback</strong>
        </label>
        <textarea id="psw" placeholder="Content" name="description" required></textarea>
        <input type="hidden" value="{{doctor.dname}}" name="doctor">
        <button type="submit" class="btn">Confirm</button>
        <button type="button" class="btn cancel" onclick="closeFormreview()">Cancel</button>
      </form>
    </div>
  </div>


  {% endblock %}

  {% block endscript %}

  <script>

// Star
$(".my-rating").starRating({
        initialRating: 3,
        useFullStars:true,
        strokeColor: '#894A00',
        strokeWidth: 10,
        starSize: 25,
      callback:function(currentRating,$el){
        document.getElementById('rating').value = currentRating;
      }

    
    });



$(document).ready(function(){
  $(".nav-tabs a").click(function(){
    $(this).tab('show');
  });




});

function rating(id){
  alert(id);
}

// Data Picker Initialization
$('#datefrom').datepicker();
$('#dateto').datepicker();
$('#expdatefrom').datepicker();
$('#expdateto').datepicker();


// Message
function openForm() {
  document.getElementById("loginPopup").style.display="block";
}

function closeForm() {
  document.getElementById("loginPopup").style.display= "none";
}
// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  var modal = document.getElementById('loginPopup');
  if (event.target == modal) {
    closeForm();
  }
}


//Education
function div_show() {
  $('#footer').css("display", "none");

document.getElementById('abc').style.display = "block";
}
function div_hide(){
  $('#footer').css("display", "block");

document.getElementById('abc').style.display = "none";
}

// Experience
function exp_show() {
  $('#footer').css("display", "none");

document.getElementById('exp').style.display = "block";
}
function exp_hide(){
  $('#footer').css("display", "block");

document.getElementById('exp').style.display = "none";
}


// Review
function openFormreview() {
  document.getElementById("reviewpopup").style.display="block";
}

function closeFormreview() {
  document.getElementById("reviewpopup").style.display= "none";
}
window.onclick = function(event) {
  var modal = document.getElementById('reviewpopup');
  if (event.target == modal) {
    closeFormreview();
  }
}


</script>
  {% endblock %}